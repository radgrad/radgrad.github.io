<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.50">


<title data-react-helmet="true">Database Dump-Restore | RadGrad 2020</title>

<meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Database Dump-Restore | RadGrad 2020"><meta data-react-helmet="true" name="description" content="RadGrad implements a custom mechanism for database dumping (i.e. outputting the contents of the MongoDB database in a file in JSON format) and restoring a dumped database (i.e. loading the contents of the dump file).  We call this capability database dump-restore."><meta data-react-helmet="true" property="og:description" content="RadGrad implements a custom mechanism for database dumping (i.e. outputting the contents of the MongoDB database in a file in JSON format) and restoring a dumped database (i.e. loading the contents of the dump file).  We call this capability database dump-restore."><meta data-react-helmet="true" property="og:url" content="https://radgrad.github.io/docs/radgrad2/datamodel/dump-restore">

<link data-react-helmet="true" rel="shortcut icon" href="/img/radgrad.ico">


<link rel="stylesheet" href="/styles.f2d7aa96.css">


<link rel="preload" href="/styles.33724544.js" as="script">

<link rel="preload" href="/runtime~main.03578e7c.js" as="script">

<link rel="preload" href="/main.a231a2dc.js" as="script">

<link rel="preload" href="/1.0e36849d.js" as="script">

<link rel="preload" href="/2.51717e34.js" as="script">

<link rel="preload" href="/3.31b1230f.js" as="script">

<link rel="preload" href="/1be78505.5e618ba6.js" as="script">

<link rel="preload" href="/20ac7829.56fb7353.js" as="script">

<link rel="preload" href="/17896441.1deddb3d.js" as="script">

<link rel="preload" href="/9deed102.75e038f5.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/radgrad_logo.png" alt="RadGrad"><strong class="navbar__title">RadGrad</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/overview/motivation">Docs</a><a class="navbar__item navbar__link" href="/blog">News</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/radgrad/" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/radgrad_logo.png" alt="RadGrad"><strong class="navbar__title">RadGrad</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/overview/motivation">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">News</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/radgrad/" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Overview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/overview/motivation">Motivation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/overview/managing-this-site">Managing this site</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/overview/engineering-standards">Engineering Standards</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/overview/remote-pair-programming">Remote Pair Programming</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/overview/markdown-reference">Markdown Guide</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/overview/mdx">Using JSX/Markdown</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">DevOps</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/devops/goals">Goals</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/devops/resources">Resources</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/devops/evaluation">Evaluation</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deployment</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/devops/deployment/heroku">Heroku</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/devops/deployment/nodechef">NodeChef</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/devops/deployment/digital-ocean">Digital Ocean</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/devops/deployment/google-cloud">Google Cloud</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/devops/deployment/microsoft-azure">Microsoft Azure</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/devops/deployment/uh-its">UH ITS</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/devops/deployment/aws">AWS</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/devops/deployment/waves-hosting">Waves Hosting</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">InternBit</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/internbit/goals">Goals</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/internbit/resources">Resources</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/internbit/scraping">Scraping</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/internbit/needs-assessment">InternBit Needs Assessment</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/internbit/canonical-schema">Canonical Schema</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/internbit/evaluation">Evaluation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CSExplore</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/csexplore/goals">Goals</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/csexplore/resources">Resources</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/csexplore/organizing-principle">Organizing Principles</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/csexplore/evaluation">Evaluation</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Mockups</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/csexplore/annotated-mockup/save-hawaii-with-computer-science">Save Hawaii with CS</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/csexplore/annotated-mockup/csexplore-ocean-earth">CSExplore Ocean and Earth</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/csexplore/annotated-mockup/find-the-path">Find the Path to CS</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/csexplore/annotated-mockup/CS-Explore-Chat">CS Explore Chat</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/csexplore/annotated-mockup/build-your-community">Build Your Community</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">RadGrad2</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/goals">Goals</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/evaluation">Evaluation</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Developer Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/developer/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/developer/ide">IDE Setup</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/developer/source-code-organization">Source code organization</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/developer/coding-standards">Coding Standards</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/developer/testing">Testing</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/developer/e2e-testing">e2e Testing</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/developer/testing-with-different-roles">Testing With Different Roles</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/developer/building-academic-plans">Academic Plans</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/developer/database-fixtures">Database Fixtures</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/developer/continuous-integration">Continuous Integration</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/developer/radgrad.org">radgrad.org</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Data Model</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/datamodel/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/datamodel/class-hierarchy">Class Hierarchy</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/datamodel/entity-relationship-model">Entity-Relationship Model</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/datamodel/user-management">User Management</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/datamodel/ice">ICE (Innovation, Competency, Experience)</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/radgrad2/datamodel/dump-restore">Database Dump-Restore</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/datamodel/pub-sub">Pub-Sub Caching</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/radgrad2/datamodel/integrity-checking">Integrity Checking</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Database Dump-Restore</h1></header><div class="markdown"><p>RadGrad implements a custom mechanism for database dumping (i.e. outputting the contents of the MongoDB database in a file in JSON format) and restoring a dumped database (i.e. loading the contents of the dump file).  We call this capability database dump-restore.</p><p>We are aware that MongoDB provides a built-in facility through <a href="https://docs.mongodb.com/manual/tutorial/backup-and-restore-tools/">MongoDB Tools</a> to dump the contents of a MongoDB database in a manner that allows reloading. We chose to develop our own custom method because we wanted a way to define database fixture files in a human-readable form, and because we were worried about database integrity problems with MongoDB as our schemas evolved and so we wanted a way to easily edit database fixture files to repair integrity violations by hand if they happened to occur. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="dump"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#dump" title="Direct link to heading">#</a>Dump</h2><p>As noted previously, in RadGrad, all collections are managed through a set of Javascript classes.  The classes that wrap each collection inherit from the class BaseCollection, which defines a method called <code>dumpOne()</code> whose default implementation throws an error:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * Returns an object representing the definition of docID in a format appropriate to the restoreOne function.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * Must be overridden by each collection.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * </span><span class="token doc-comment comment keyword" style="color:rgb(105, 112, 152);font-style:italic">@param</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:rgb(105, 112, 152);font-style:italic">docID</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> A docID from this collection.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * </span><span class="token doc-comment comment keyword" style="color:rgb(105, 112, 152);font-style:italic">@returns</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment class-name punctuation" style="color:rgb(199, 146, 234);font-style:italic">{</span><span class="token doc-comment comment class-name" style="color:rgb(255, 203, 107);font-style:italic"> Object </span><span class="token doc-comment comment class-name punctuation" style="color:rgb(199, 146, 234);font-style:italic">}</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> An object representing this document.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">dumpOne</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">docID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// eslint-disable-line</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">throw</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Meteor</span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token template-string string" style="color:rgb(195, 232, 141)">Default dumpOne method invoked by collection </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation keyword" style="font-style:italic">this</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token template-string interpolation">_collectionName</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><p>Each collection class must define a dumpOne method, which is generates an object representing the docID that it was passed. For example, here is the <code>dumpOne()</code> method for the CareerGoal collection:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * Returns an object representing the CareerGoal docID in a format acceptable to define().</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * </span><span class="token doc-comment comment keyword" style="color:rgb(105, 112, 152);font-style:italic">@param</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:rgb(105, 112, 152);font-style:italic">docID</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> The docID of a CareerGoal.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * </span><span class="token doc-comment comment keyword" style="color:rgb(105, 112, 152);font-style:italic">@returns</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment class-name punctuation" style="color:rgb(199, 146, 234);font-style:italic">{</span><span class="token doc-comment comment class-name" style="color:rgb(255, 203, 107);font-style:italic"> Object </span><span class="token doc-comment comment class-name punctuation" style="color:rgb(199, 146, 234);font-style:italic">}</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> An object representing the definition of docID.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">dumpOne</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">docID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> doc </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">findDoc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">docID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> doc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> slug </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Slugs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getNameFromID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">doc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">slugID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> description </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> doc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> interests </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">doc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">interestIDs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token parameter">interestID</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token maybe-class-name">Interests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">findSlugByID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">interestID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> slug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> interests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> description </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><p>You can see that this method returns an object with four fields: name, slug, interests, and description. Name, slug, and description are Strings, and Interests is an array of Strings (the Slugs corresponding to the InterestIDs in the document).</p><p>Now the question is, why is that the appropriate object to return from dumpOne?  To understand the answer, you need to also know that each Javascript class also defines a method called <code>define()</code> which accepts an object containing fields representing the initial values for a document in the underlying MongoDB collection. This is the standard way in RadGrad to create MongoDB documents in the data model.  Here, for example, is the define() method for the CareerGoal collection:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * Defines a new CareerGoal with its name, slug, and description.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * </span><span class="token doc-comment comment keyword" style="color:rgb(105, 112, 152);font-style:italic">@example</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   </span><span class="token doc-comment comment example" style="color:rgb(105, 112, 152);font-style:italic">* </span><span class="token doc-comment comment example code language-javascript maybe-class-name" style="color:rgb(105, 112, 152);font-style:italic">CareerGoals</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">.</span><span class="token doc-comment comment example code language-javascript method function property-access" style="color:rgb(130, 170, 255);font-style:italic">define</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">(</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">{</span><span class="token doc-comment comment example code language-javascript" style="color:rgb(105, 112, 152);font-style:italic"> name</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">:</span><span class="token doc-comment comment example code language-javascript" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment example code language-javascript string" style="color:rgb(195, 232, 141);font-style:italic">&#x27;Database Administrator&#x27;</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">,</span><span class="token doc-comment comment example" style="color:rgb(105, 112, 152);font-style:italic"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment example" style="color:rgb(105, 112, 152);font-style:italic">   *                      </span><span class="token doc-comment comment example code language-javascript" style="color:rgb(105, 112, 152);font-style:italic">slug</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">:</span><span class="token doc-comment comment example code language-javascript" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment example code language-javascript string" style="color:rgb(195, 232, 141);font-style:italic">&#x27;database-administrator&#x27;</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">,</span><span class="token doc-comment comment example" style="color:rgb(105, 112, 152);font-style:italic"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment example" style="color:rgb(105, 112, 152);font-style:italic">   *                      </span><span class="token doc-comment comment example code language-javascript" style="color:rgb(105, 112, 152);font-style:italic">description</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">:</span><span class="token doc-comment comment example code language-javascript" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment example code language-javascript string" style="color:rgb(195, 232, 141);font-style:italic">&#x27;Wrangler of SQL.&#x27;</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">,</span><span class="token doc-comment comment example" style="color:rgb(105, 112, 152);font-style:italic"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment example" style="color:rgb(105, 112, 152);font-style:italic">   *                      </span><span class="token doc-comment comment example code language-javascript" style="color:rgb(105, 112, 152);font-style:italic">interests</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">:</span><span class="token doc-comment comment example code language-javascript" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">[</span><span class="token doc-comment comment example code language-javascript string" style="color:rgb(195, 232, 141);font-style:italic">&#x27;application-development&#x27;</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">,</span><span class="token doc-comment comment example code language-javascript" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment example code language-javascript string" style="color:rgb(195, 232, 141);font-style:italic">&#x27;software-engineering&#x27;</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">,</span><span class="token doc-comment comment example code language-javascript" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment example code language-javascript string" style="color:rgb(195, 232, 141);font-style:italic">&#x27;databases&#x27;</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">]</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">,</span><span class="token doc-comment comment example" style="color:rgb(105, 112, 152);font-style:italic"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment example" style="color:rgb(105, 112, 152);font-style:italic">   *                    </span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">}</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">)</span><span class="token doc-comment comment example code language-javascript punctuation" style="color:rgb(199, 146, 234);font-style:italic">;</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * </span><span class="token doc-comment comment keyword" style="color:rgb(105, 112, 152);font-style:italic">@param</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment class-name punctuation" style="color:rgb(199, 146, 234);font-style:italic">{</span><span class="token doc-comment comment class-name" style="color:rgb(255, 203, 107);font-style:italic"> Object </span><span class="token doc-comment comment class-name punctuation" style="color:rgb(199, 146, 234);font-style:italic">}</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:rgb(105, 112, 152);font-style:italic">description</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> Object with keys name, slug, description, interests.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * Slug must be globally unique and previously undefined.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * Interests is a (possibly empty) array of defined interest slugs or interestIDs.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * Syllabus is optional. If supplied, should be a URL.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * </span><span class="token doc-comment comment keyword" style="color:rgb(105, 112, 152);font-style:italic">@throws</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> </span><span class="token doc-comment comment class-name punctuation" style="color:rgb(199, 146, 234);font-style:italic">{</span><span class="token doc-comment comment class-name" style="color:rgb(255, 203, 107);font-style:italic"> Meteor</span><span class="token doc-comment comment class-name punctuation" style="color:rgb(199, 146, 234);font-style:italic">.</span><span class="token doc-comment comment class-name" style="color:rgb(255, 203, 107);font-style:italic">Error </span><span class="token doc-comment comment class-name punctuation" style="color:rgb(199, 146, 234);font-style:italic">}</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> If the slug already exists.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   * </span><span class="token doc-comment comment keyword" style="color:rgb(105, 112, 152);font-style:italic">@returns</span><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic"> The newly created docID.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token doc-comment comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">define</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> name</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> slug</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> description</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> interests </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Get Interests, throw error if any of them are not found.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> interestIDs </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Interests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getIDs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">interests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Get SlugID, throw error if found.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> slugID </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Slugs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">define</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> slug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> entityName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> docID </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">_collection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">insert</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> slugID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> interestIDs </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Connect the Slug to this Interest</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token maybe-class-name">Slugs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">updateEntityID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slugID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> docID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> docID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><p>It&#x27;s not necessary to understand the implementation of this define() method at this point: what is important to see is that the object returned by the dumpOne() method of the CareerGoalCollection class is in precisely the correct format required by the define() method of that same class in order to create a new CareerGoal document.</p><p>This relationship between <code>dumpOne()</code> and <code>define()</code> is the central idea behind RadGrad&#x27;s dump mechanism. There is more code to implement the mechanics of dumping:  iterating through each docID in each collection,writing out the results as a json file, determining where to write the file, and so forth. But if you understand and can adhere to this relationship between <code>dumpOne</code> and <code>define()</code>, then you can create new classes and manage other ones successfully. </p><p>Note that whenever a change is made the parameters to a <code>define()</code> method, you must make sure to update the <code>dumpOne()</code> method as well!  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="restore"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#restore" title="Direct link to heading">#</a>Restore</h2><p>&quot;Restore&quot; refers to the process of initializing the MongoDB database from scratch with the contents of a file created through the &quot;Dump&quot; mechanism. </p><p>The  process of database restoration involves the following sequence:</p><p>First, the developer specifies a field called &quot;databaseRestoreFileName&quot; in the JSON settings file passed to Meteor. For example:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">&quot;databaseRestoreFileName&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;database/snapshot/2017-08-02-14-12-04.json&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span></div></div></div></div></div><p>The value of this field is a path within the <code>private</code> directory of the RadGrad application. Here&#x27;s <a href="https://github.com/radgrad/radgrad/blob/master/app/private/database/snapshot/2017-08-02-14-12-04.json">2017-08-14-12-04.json</a>.</p><p>If and only if the database is empty when the system comes up, then the contents of this file will be used to initialize the database.    See the loadDatabase() function in <a href="https://github.com/radgrad/radgrad/blob/master/app/imports/startup/server/initialize-db.js">initialize-db.js</a> to see the process.</p><p>To ensure that the database being loaded is consistent with the system&#x27;s data model, the loading process requires that two constraints are met:</p><ol><li>The set of collections expected in the RadGrad application are all present in the database json file.</li><li>There are no collections present in the database json file that are not expected by the application. </li></ol><p>In other words, the database json file contains exactly the set of collections required by RadGrad.</p><p>There are other ways the loading process can fail.  As noted elsewhere, entities in the data model can link to each other. For example, a StudentProfile instance can contain a list of docIDs of the Interests associated with the student.  There can be no forward referencing in RadGrad, so any Interest associated with a StudentProfile must be defined prior to defining the profile instance. </p></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/radgrad2/datamodel/ice"><div class="pagination-nav__link--sublabel">Previous</div><div class="pagination-nav__link--label"> ICE (Innovation, Competency, Experience)</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/radgrad2/datamodel/pub-sub"><div class="pagination-nav__link--sublabel">Next</div><div class="pagination-nav__link--label">Pub-Sub Caching </div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#dump" class="contents__link">Dump</a></li><li><a href="#restore" class="contents__link">Restore</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/markdown-reference">Markdown Guide</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://radgrad2.slack.com">Slack</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">News</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/radgrad/">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright  2020 University of Hawaii.</div></div></div></footer>
</div>

<script src="/styles.33724544.js"></script>

<script src="/runtime~main.03578e7c.js"></script>

<script src="/main.a231a2dc.js"></script>

<script src="/1.0e36849d.js"></script>

<script src="/2.51717e34.js"></script>

<script src="/3.31b1230f.js"></script>

<script src="/1be78505.5e618ba6.js"></script>

<script src="/20ac7829.56fb7353.js"></script>

<script src="/17896441.1deddb3d.js"></script>

<script src="/9deed102.75e038f5.js"></script>


</body>
</html>